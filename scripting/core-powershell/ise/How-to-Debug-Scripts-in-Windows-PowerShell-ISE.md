---
ms.date: 2017-06-05
keywords: powershell,applet de commande
title: "Comment déboguer des scripts dans Windows PowerShell ISE"
ms.assetid: 6dc6d8f9-8978-46e9-a92f-169af37e2817
ms.openlocfilehash: db8847e2cc9abeec729ed8d939fc170529a93846
ms.sourcegitcommit: 598b7835046577841aea2211d613bb8513271a8b
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/08/2017
---
# <a name="how-to-debug-scripts-in-windows-powershell-ise"></a><span data-ttu-id="e625e-103">Comment déboguer des scripts dans Windows PowerShell ISE</span><span class="sxs-lookup"><span data-stu-id="e625e-103">How to Debug Scripts in Windows PowerShell ISE</span></span>
<span data-ttu-id="e625e-104">Cette rubrique décrit comment déboguer des scripts sur un ordinateur local à l’aide des fonctionnalités de débogage visuel de l’environnement d’écriture de scripts intégré de Windows PowerShell® ( Windows PowerShell ISE).</span><span class="sxs-lookup"><span data-stu-id="e625e-104">This topic describes how to debug scripts on a local computer by using the Windows PowerShell® Integrated Scripting Environment (ISE) visual debugging features.</span></span>

<span data-ttu-id="e625e-105">[Comment gérer les points d’arrêt](#bkmk_1)
[Comment gérer une session de débogage](#bkmk_2)
[Comment effectuer une opération de pas à pas principal, de pas à pas détaillé et de pas à pas sortant lors d’un débogage](#bkmk_3)
[Comment afficher les valeurs de variables lors d’un débogage](#bkmk_4)</span><span class="sxs-lookup"><span data-stu-id="e625e-105">[How to manage breakpoints](#bkmk_1)
[How to manage a debugging session](#bkmk_2)
[How to step over, step into, and step out while debugging](#bkmk_3)
[How to display the values of variables while debugging](#bkmk_4)</span></span>

## <span data-ttu-id="e625e-106"><a name="bkmk_1"></a>Comment gérer les points d’arrêt</span><span class="sxs-lookup"><span data-stu-id="e625e-106"><a name="bkmk_1"></a>How to manage breakpoints</span></span>
<span data-ttu-id="e625e-107">Un point d’arrêt est un endroit désigné dans un script, où vous souhaitez que l’opération s’interrompe afin que de pouvoir examiner l’état actuel des variables et de l’environnement dans lequel votre script s’exécute.</span><span class="sxs-lookup"><span data-stu-id="e625e-107">A breakpoint is a designated spot in a script where you would like operation to pause so that you can examine the current state of the variables and the environment in which your script is running.</span></span> <span data-ttu-id="e625e-108">Une fois votre script interrompu par un point d’arrêt, vous pouvez exécuter des commandes dans le volet Console pour examiner l’état de votre script.</span><span class="sxs-lookup"><span data-stu-id="e625e-108">Once your script is paused by a breakpoint, you can run commands in the Console Pane to examine the state of your script.</span></span>  <span data-ttu-id="e625e-109">Vous pouvez extraire des variables ou exécuter d’autres commandes.</span><span class="sxs-lookup"><span data-stu-id="e625e-109">You can output variables or run other commands.</span></span> <span data-ttu-id="e625e-110">Vous pouvez même modifier la valeur de toutes les variables visibles dans le contexte du script en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="e625e-110">You can even modify the value of any variables that are visible to the context of the currently running script.</span></span> <span data-ttu-id="e625e-111">Après avoir examiné ce que vous voulez voir, vous pouvez reprendre l’exécution du script.</span><span class="sxs-lookup"><span data-stu-id="e625e-111">After you have examined what you want to see, you can resume operation of the script.</span></span>

<span data-ttu-id="e625e-112">Dans l’environnement de débogage de Windows PowerShell, vous pouvez définir trois types de points d’arrêt :</span><span class="sxs-lookup"><span data-stu-id="e625e-112">You can set three types of breakpoints in the Windows PowerShell debugging environment:</span></span>

1.  <span data-ttu-id="e625e-113">**Point d’arrêt de ligne**.</span><span class="sxs-lookup"><span data-stu-id="e625e-113">**Line breakpoint**.</span></span> <span data-ttu-id="e625e-114">L’exécution du script s’interrompt quand la ligne désignée est atteinte.</span><span class="sxs-lookup"><span data-stu-id="e625e-114">The script pauses when the designated line is reached during the operation of the script</span></span>

2.  <span data-ttu-id="e625e-115">**Point d’arrêt de variable.**</span><span class="sxs-lookup"><span data-stu-id="e625e-115">**Variable breakpoint.**</span></span> <span data-ttu-id="e625e-116">L’exécution du script s’interrompt chaque fois que la valeur de la variable désignée change.</span><span class="sxs-lookup"><span data-stu-id="e625e-116">The script pauses whenever the designated variable’s value changes.</span></span>

3.  <span data-ttu-id="e625e-117">**Point d’arrêt de commande.**</span><span class="sxs-lookup"><span data-stu-id="e625e-117">**Command breakpoint.**</span></span> <span data-ttu-id="e625e-118">L’exécution du script s’interrompt chaque fois que la commande désignée est sur le point d’être exécutée.</span><span class="sxs-lookup"><span data-stu-id="e625e-118">The script pauses whenever the designated command is about to be run during the operation of the script.</span></span> <span data-ttu-id="e625e-119">Il est possible d’inclure des paramètres pour filtrer davantage le point d’arrêt uniquement pour l’opération souhaitée.</span><span class="sxs-lookup"><span data-stu-id="e625e-119">It can include parameters to further filter the breakpoint to only the operation you want.</span></span> <span data-ttu-id="e625e-120">La commande peut également être une fonction que vous créez.</span><span class="sxs-lookup"><span data-stu-id="e625e-120">The command can also be a function you created.</span></span>

<span data-ttu-id="e625e-121">Dans l’environnement de débogage de Windows PowerShell ISE, seuls des points d’arrêt de ligne peuvent être définis à l’aide du menu ou des raccourcis clavier.</span><span class="sxs-lookup"><span data-stu-id="e625e-121">Of these, in the Windows PowerShell ISE debugging environment, only line breakpoints can be set by using the menu or the keyboard shortcuts.</span></span> <span data-ttu-id="e625e-122">Les deux autres types de points d’arrêt doivent être définis à partir du volet Console à l’aide de l’applet de commande [Set-PSBreakpoint](https://technet.microsoft.com/library/88d2d9ad-17dc-44ae-99aa-f841125b9dc8).</span><span class="sxs-lookup"><span data-stu-id="e625e-122">The other two types of breakpoints can be set, but they are set from the Console Pane by using the [Set-PSBreakpoint](https://technet.microsoft.com/library/88d2d9ad-17dc-44ae-99aa-f841125b9dc8) cmdlet.</span></span> <span data-ttu-id="e625e-123">Cette section décrit comment effectuer des tâches de débogage dans Windows PowerShell ISE en utilisant les menus disponibles, et exécuter un éventail plus large de commandes à partir du volet Console à l’aide de scripts.</span><span class="sxs-lookup"><span data-stu-id="e625e-123">This section describes how you can perform debugging tasks in Windows PowerShell ISE by using the menus where available, and perform a wider range of commands from the Console Pane by using scripting.</span></span>

### <a name="to-set-a-breakpoint"></a><span data-ttu-id="e625e-124">Pour définir un point d’arrêt</span><span class="sxs-lookup"><span data-stu-id="e625e-124">To set a breakpoint</span></span>
<span data-ttu-id="e625e-125">Un point d’arrêt ne peut être défini dans un script qu’après l’enregistrement de celui-ci.</span><span class="sxs-lookup"><span data-stu-id="e625e-125">A breakpoint can be set in a script only after it has been saved.</span></span> <span data-ttu-id="e625e-126">Cliquez avec le bouton droit sur la ligne dans laquelle vous souhaitez définir un point d’arrêt de ligne, puis cliquez sur **Basculer le point d’arrêt**.</span><span class="sxs-lookup"><span data-stu-id="e625e-126">Right-click the line where you want to set a line breakpoint, and then click **Toggle Breakpoint**.</span></span> <span data-ttu-id="e625e-127">Vous pouvez également cliquer sur la ligne dans laquelle vous souhaitez définir un point d’arrêt de ligne, puis appuyer sur **F9** ou, dans le menu **Déboguer**, cliquer sur **Basculer le point d’arrêt**.</span><span class="sxs-lookup"><span data-stu-id="e625e-127">Or, click the line where you want to set a line breakpoint, and press **F9** or, on the **Debug** menu, click **Toggle Breakpoint**.</span></span>

<span data-ttu-id="e625e-128">Le script suivant montre comment définir un point d’arrêt de variable à partir du volet Console en utilisant l’applet de commande [Set-PSBreakpoint](https://technet.microsoft.com/library/6afd5d2c-a285-4796-8607-3cbf49471420).</span><span class="sxs-lookup"><span data-stu-id="e625e-128">The following script is an example of how you can set a variable breakpoint from the Console Pane by using the [Set-PSBreakpoint](https://technet.microsoft.com/library/6afd5d2c-a285-4796-8607-3cbf49471420) cmdlet.</span></span>

``` PowerShell
# This command sets a breakpoint on the Server variable in the Sample.ps1 script.
Set-PSBreakpoint -Script sample.ps1 -Variable Server
```

### <a name="list-all-breakpoints"></a><span data-ttu-id="e625e-129">Liste de tous les points d’arrêt</span><span class="sxs-lookup"><span data-stu-id="e625e-129">List all breakpoints</span></span>
<span data-ttu-id="e625e-130">Affiche tous les points d’arrêt dans la session Windows PowerShell® actuelle.</span><span class="sxs-lookup"><span data-stu-id="e625e-130">Displays all breakpoints in the current Windows PowerShell® session.</span></span>

<span data-ttu-id="e625e-131">Dans le menu **Déboguer**, cliquez sur **Lister les points d’arrêt**.</span><span class="sxs-lookup"><span data-stu-id="e625e-131">On the **Debug** menu, click **List Breakpoints**.</span></span> <span data-ttu-id="e625e-132">Le script suivant montre comment répertorier tous les points d’arrêt à partir du volet Console en utilisant l’applet de commande [Get-PSBreakpoint](https://technet.microsoft.com/library/0bf48936-00ab-411c-b5e0-9b10a812a3c6).</span><span class="sxs-lookup"><span data-stu-id="e625e-132">The following script is an example of how you can list all breakpoints from the Console Pane by using the [Get-PSBreakpoint](https://technet.microsoft.com/library/0bf48936-00ab-411c-b5e0-9b10a812a3c6) cmdlet.</span></span>

``` PowerShell
# This command lists all breakpoints in the current session. 
Get-PSBreakpoint
```

### <a name="remove-a-breakpoint"></a><span data-ttu-id="e625e-133">Supprimer un point d’arrêt</span><span class="sxs-lookup"><span data-stu-id="e625e-133">Remove a breakpoint</span></span>
<span data-ttu-id="e625e-134">La suppression d’un point d’arrêt revient à effacer celui-ci.</span><span class="sxs-lookup"><span data-stu-id="e625e-134">Removing a breakpoint deletes it.</span></span>  <span data-ttu-id="e625e-135">Si vous pensez que vous pourriez être amené à le réutiliser ultérieurement, envisagez plutôt de le [désactiver](#bkmk_disable).</span><span class="sxs-lookup"><span data-stu-id="e625e-135">If you think you might want to use it again later, consider [disabling](#bkmk_disable) it instead.</span></span>  <span data-ttu-id="e625e-136">Cliquez avec le bouton droit sur la ligne dans laquelle vous souhaitez supprimer un point d’arrêt, puis cliquez sur **Basculer le point d’arrêt**.</span><span class="sxs-lookup"><span data-stu-id="e625e-136">Right-click the line where you want to remove a breakpoint, and then click **Toggle Breakpoint**.</span></span> <span data-ttu-id="e625e-137">Vous pouvez également cliquer sur la ligne dans laquelle vous souhaitez supprimer un point d’arrêt, puis, dans le menu **Déboguer**, cliquer sur **Basculer le point d’arrêt**.</span><span class="sxs-lookup"><span data-stu-id="e625e-137">Or, click the line where you want to remove a breakpoint, and on the **Debug** menu, click **Toggle Breakpoint**.</span></span> <span data-ttu-id="e625e-138">Le script suivant montre comment supprimer un point d’arrêt avec un ID spécifié à partir du volet Console en utilisant l’applet de commande [Remove-PSBreakpoint](https://technet.microsoft.com/library/4c877a80-0ea0-4790-9281-88c08ef0ddd6).</span><span class="sxs-lookup"><span data-stu-id="e625e-138">The following script is an example of how to remove a breakpoint with a specified ID from the Console Pane by using the [Remove-PSBreakpoint](https://technet.microsoft.com/library/4c877a80-0ea0-4790-9281-88c08ef0ddd6) cmdlet.</span></span>

``` PowerShell
# This command deletes the breakpoint with breakpoint ID 2.
Remove-PSBreakpoint -Id 2
```

### <a name="remove-all-breakpoints"></a><span data-ttu-id="e625e-139">Supprimer tous les points d’arrêt</span><span class="sxs-lookup"><span data-stu-id="e625e-139">Remove All Breakpoints</span></span>
<span data-ttu-id="e625e-140">Pour supprimer tous les points d’arrêt définis dans la session active, dans le menu **Déboguer**, cliquez sur **Supprimer tous les points d’arrêt**.</span><span class="sxs-lookup"><span data-stu-id="e625e-140">To remove all breakpoints defined in the current session, on the **Debug** menu, click **Remove All Breakpoints**.</span></span>

<span data-ttu-id="e625e-141">Le script suivant montre comment supprimer tous les points d’arrêt à partir du volet Console en utilisant l’applet de commande [Remove-PSBreakpoint](https://technet.microsoft.com/library/4c877a80-0ea0-4790-9281-88c08ef0ddd6).</span><span class="sxs-lookup"><span data-stu-id="e625e-141">The following script is an example of how to remove all breakpoints from the Console Pane by using the [Remove-PSBreakpoint](https://technet.microsoft.com/library/4c877a80-0ea0-4790-9281-88c08ef0ddd6) cmdlet.</span></span>

``` PowerShell
# This command deletes all of the breakpoints in the current session.
Get-PSBreakpoint | Remove-PSBreakpoint
```

### <span data-ttu-id="e625e-142"><a name="bkmk_disable"></a>Désactiver un point d’arrêt</span><span class="sxs-lookup"><span data-stu-id="e625e-142"><a name="bkmk_disable"></a>Disable a Breakpoint</span></span>
<span data-ttu-id="e625e-143">La désactivation d’un point d’arrêt n’a pas pour effet de supprimer celui-ci, mais uniquement de le mettre hors service jusqu’à sa réactivation éventuelle.</span><span class="sxs-lookup"><span data-stu-id="e625e-143">Disabling a breakpoint does not remove it; it turns it off until it is enabled.</span></span>  <span data-ttu-id="e625e-144">Pour désactiver un point d’arrêt de ligne spécifique, cliquez avec le bouton droit sur la ligne dans laquelle vous souhaitez désactiver ce point d’arrêt, puis cliquez sur **Désactiver le point d’arrêt**.</span><span class="sxs-lookup"><span data-stu-id="e625e-144">To disable a specific line breakpoint, right-click the line where you want to disable a breakpoint, and then click **Disable Breakpoint**.</span></span> <span data-ttu-id="e625e-145">Vous pouvez également cliquer sur la ligne dans laquelle vous souhaitez désactiver un point d’arrêt, puis appuyer sur **F9** ou, dans le menu **Déboguer**, cliquer sur **Désactiver le point d’arrêt**.</span><span class="sxs-lookup"><span data-stu-id="e625e-145">Or, click the line where you want to disable a breakpoint, and press **F9** or, on the **Debug** menu, click **Disable Breakpoint**.</span></span> <span data-ttu-id="e625e-146">Le script suivant montre comment supprimer un point d’arrêt avec un ID spécifié à partir du volet Console en utilisant l’applet de commande [Disable-PSBreakpoint](https://technet.microsoft.com/library/d4974e9b-0aaa-4e20-b87f-f599a413e4e8).</span><span class="sxs-lookup"><span data-stu-id="e625e-146">The following script is an example of how you can remove a breakpoint with a specified ID from the Console Pane by using the [Disable-PSBreakpoint](https://technet.microsoft.com/library/d4974e9b-0aaa-4e20-b87f-f599a413e4e8) cmdlet.</span></span>

``` PowerShell
# This command disables the breakpoint with breakpoint ID 0.
Disable-PSBreakpoint -Id 0
```

### <a name="disable-all-breakpoints"></a><span data-ttu-id="e625e-147">Désactiver tous les points d’arrêt</span><span class="sxs-lookup"><span data-stu-id="e625e-147">Disable All Breakpoints</span></span>
<span data-ttu-id="e625e-148">La désactivation d’un point d’arrêt n’a pas pour effet de supprimer celui-ci, mais uniquement de le mettre hors service jusqu’à sa réactivation éventuelle.</span><span class="sxs-lookup"><span data-stu-id="e625e-148">Disabling a breakpoint does not remove it; it turns it off until it is enabled.</span></span>  <span data-ttu-id="e625e-149">Pour désactiver tous les points d’arrêt dans la session active, dans le menu **Déboguer**, cliquez sur **Désactiver tous les points d’arrêt**.</span><span class="sxs-lookup"><span data-stu-id="e625e-149">To disable all breakpoints in the current session, on the **Debug** menu, click **Disable all Breakpoints**.</span></span> <span data-ttu-id="e625e-150">Le script suivant montre comment désactiver tous les points d’arrêt à partir du volet Console en utilisant l’applet de commande [Disable-PSBreakpoint](https://technet.microsoft.com/library/d4974e9b-0aaa-4e20-b87f-f599a413e4e8).</span><span class="sxs-lookup"><span data-stu-id="e625e-150">The following script is an example of how you can disable all breakpoints from the Console Pane by using the [Disable-PSBreakpoint](https://technet.microsoft.com/library/d4974e9b-0aaa-4e20-b87f-f599a413e4e8) cmdlet.</span></span>

``` PowerShell
# This command disables all breakpoints in the current session. 
# You can abbreviate this command as: "gbp | dbp".
Get-PSBreakpoint | Disable-PSBreakpoint
```

### <a name="enable-a-breakpoint"></a><span data-ttu-id="e625e-151">Activer un point d’arrêt</span><span class="sxs-lookup"><span data-stu-id="e625e-151">Enable a Breakpoint</span></span>
<span data-ttu-id="e625e-152">Pour activer un point d’arrêt spécifique, cliquez avec le bouton droit sur la ligne dans laquelle vous souhaitez activer ce point d’arrêt, puis cliquez sur **Activer le point d’arrêt**.</span><span class="sxs-lookup"><span data-stu-id="e625e-152">To enable a specific breakpoint, right-click the line where you want to enable a breakpoint, and then click **Enable Breakpoint**.</span></span> <span data-ttu-id="e625e-153">Vous pouvez également cliquer sur la ligne dans laquelle vous souhaitez activer un point d’arrêt, puis appuyer sur **F9** ou, dans le menu **Déboguer**, cliquer sur **Activer le point d’arrêt**.</span><span class="sxs-lookup"><span data-stu-id="e625e-153">Or, click the line where you want to enable a breakpoint, and then press **F9** or, on the **Debug** menu, click **Enable Breakpoint**.</span></span> <span data-ttu-id="e625e-154">Le script suivant montre comment activer des points d’arrêt spécifiques à partir du volet Console en utilisant l’applet de commande [Enable-PSBreakpoint](https://technet.microsoft.com/library/739e1091-3b3f-405f-a428-bec7543e5df0).</span><span class="sxs-lookup"><span data-stu-id="e625e-154">The following script is an example of how you can enable specific breakpoints from the Console Pane by using the [Enable-PSBreakpoint](https://technet.microsoft.com/library/739e1091-3b3f-405f-a428-bec7543e5df0) cmdlet.</span></span>

``` PowerShell
# This command enables breakpoints with breakpoint IDs 0, 1, and 5.
Enable-PSBreakpoint -Id 0, 1, 5
```

### <a name="enable-all-breakpoints"></a><span data-ttu-id="e625e-155">Activer tous les points d’arrêt</span><span class="sxs-lookup"><span data-stu-id="e625e-155">Enable All Breakpoints</span></span>
<span data-ttu-id="e625e-156">Pour activer tous les points d’arrêt définis dans la session active, dans le menu **Déboguer**, cliquez sur **Activer tous les points d’arrêt**.</span><span class="sxs-lookup"><span data-stu-id="e625e-156">To enable all breakpoints defined in the current session, on the **Debug** menu, click **Enable all Breakpoints**.</span></span> <span data-ttu-id="e625e-157">Le script suivant montre comment activer tous les points d’arrêt à partir du volet Console en utilisant l’applet de commande [Enable-PSBreakpoint](https://technet.microsoft.com/library/739e1091-3b3f-405f-a428-bec7543e5df0).</span><span class="sxs-lookup"><span data-stu-id="e625e-157">The following script is an example of how you can enable all breakpoints from the Console Pane by using the [Enable-PSBreakpoint](https://technet.microsoft.com/library/739e1091-3b3f-405f-a428-bec7543e5df0) cmdlet.</span></span>

``` PowerShell
# This command enables all breakpoints in the current session. 
# You can abbreviate the command by using their aliases: "gbp | ebp".
Get-PSBreakpoint | Enable-PSBreakpoint
```

## <span data-ttu-id="e625e-158"><a name="bkmk_2"></a>Comment gérer une session de débogage</span><span class="sxs-lookup"><span data-stu-id="e625e-158"><a name="bkmk_2"></a>How to manage a debugging session</span></span>
<span data-ttu-id="e625e-159">Avant de commencer le débogage, vous devez définir un ou plusieurs points d’arrêt.</span><span class="sxs-lookup"><span data-stu-id="e625e-159">Before you start debugging, you must set one or more breakpoints.</span></span> <span data-ttu-id="e625e-160">Vous ne pouvez définir un point d’arrêt que si le script que vous souhaitez déboguer est enregistré.</span><span class="sxs-lookup"><span data-stu-id="e625e-160">You cannot set a breakpoint unless the script that you want to debug is saved.</span></span> <span data-ttu-id="e625e-161">Pour des instructions sur la définition d’un point d’arrêt, voir [Comment gérer les points d’arrêt](#bkmk_1) ou [Set-PSBreakpoint](https://technet.microsoft.com/library/6afd5d2c-a285-4796-8607-3cbf49471420).</span><span class="sxs-lookup"><span data-stu-id="e625e-161">For directions on of how to set a breakpoint, see [How to manage breakpoints](#bkmk_1) or [Set-PSBreakpoint](https://technet.microsoft.com/library/6afd5d2c-a285-4796-8607-3cbf49471420).</span></span> <span data-ttu-id="e625e-162">Une fois le débogage démarré, vous ne pouvez modifier un script qu’après avoir arrêté le débogage.</span><span class="sxs-lookup"><span data-stu-id="e625e-162">After you start debugging, you cannot edit a script until you stop debugging.</span></span> <span data-ttu-id="e625e-163">Un script dans lequel un ou plusieurs points d’arrêt sont définis est automatiquement enregistré avant son exécution.</span><span class="sxs-lookup"><span data-stu-id="e625e-163">A script that has one or more breakpoints set is automatically saved before it is run.</span></span>

### <a name="to-start-debugging"></a><span data-ttu-id="e625e-164">Pour commencer le débogage</span><span class="sxs-lookup"><span data-stu-id="e625e-164">To start debugging</span></span>
<span data-ttu-id="e625e-165">Appuyez sur **F5** ou, dans la barre d’outils, cliquez sur l’icône **Exécuter le script**. Ou encore, dans le menu **Déboguer**, cliquez sur **Exécuter/Continuer**.</span><span class="sxs-lookup"><span data-stu-id="e625e-165">Press **F5** or, on the toolbar, click the **Run Script** icon, or on the **Debug** menu click **Run/Continue**.</span></span> <span data-ttu-id="e625e-166">Le script s’exécute jusqu’à ce qu’il rencontre le premier point d’arrêt.</span><span class="sxs-lookup"><span data-stu-id="e625e-166">The script runs until it encounters the first breakpoint.</span></span> <span data-ttu-id="e625e-167">Il suspend alors l’opération et met en surbrillance la ligne sur laquelle il s’est arrêté.</span><span class="sxs-lookup"><span data-stu-id="e625e-167">It pauses operation there and highlights the line on which it paused.</span></span>

### <a name="to-continue-debugging"></a><span data-ttu-id="e625e-168">Pour continuer le débogage</span><span class="sxs-lookup"><span data-stu-id="e625e-168">To continue debugging</span></span>
<span data-ttu-id="e625e-169">Appuyez sur **F5** ou, dans la barre d’outils, cliquez sur l’icône **Exécuter le script**. Ou bien, dans le menu **Déboguer**, cliquez sur **Exécuter/Continuer**. Ou encore, dans le volet Console, tapez sur **C** puis appuyez sur **Entrée**.</span><span class="sxs-lookup"><span data-stu-id="e625e-169">Press **F5** or, on the toolbar, click the **Run Script** icon, or on the **Debug** menu, click **Run/Continue** or, in the Console Pane, type **C** and then press **ENTER**.</span></span> <span data-ttu-id="e625e-170">Le script poursuit alors son exécution jusqu’au point d’arrêt suivant ou jusqu’à la fin s’il ne rencontre plus d’autre point d’arrêt.</span><span class="sxs-lookup"><span data-stu-id="e625e-170">This causes the script to continue running to the next breakpoint or to the end of the script if no further breakpoints are encountered.</span></span>

### <a name="to-view-the-call-stack"></a><span data-ttu-id="e625e-171">Pour afficher la pile des appels</span><span class="sxs-lookup"><span data-stu-id="e625e-171">To view the call stack</span></span>
<span data-ttu-id="e625e-172">La pile des appels affiche l’emplacement d’exécution actuel dans le script.</span><span class="sxs-lookup"><span data-stu-id="e625e-172">The call stack displays the current run location in the script.</span></span> <span data-ttu-id="e625e-173">Si le script s’exécute dans une fonction appelée par une autre fonction, cela est indiqué dans l’affichage par des lignes supplémentaires dans la sortie.</span><span class="sxs-lookup"><span data-stu-id="e625e-173">If the script is running in a function that was called by a different function, then that is represented in the display by additional rows in the output.</span></span> <span data-ttu-id="e625e-174">La ligne inférieure affiche le script d’origine et la ligne de celui-ci dans laquelle une fonction a été appelée.</span><span class="sxs-lookup"><span data-stu-id="e625e-174">The bottom-most row displays the original script and the line in it in which a function was called.</span></span> <span data-ttu-id="e625e-175">La ligne juste au-dessus affiche cette fonction et la ligne dans laquelle une autre fonction pourrait avoir été appelée.</span><span class="sxs-lookup"><span data-stu-id="e625e-175">The next line up shows that function and the line in it in which another function might have been called.</span></span>  <span data-ttu-id="e625e-176">La dernière supérieure affiche le contexte actuel de la ligne active sur laquelle le point d’arrêt est défini.</span><span class="sxs-lookup"><span data-stu-id="e625e-176">The top-most row shows the current context of the current line on which the breakpoint is set.</span></span>

<span data-ttu-id="e625e-177">Pendant la suspension, pour afficher la pile des appels active, appuyez sur **Ctrl+Maj+D** ou, dans le menu **Déboguer**, cliquez sur **Afficher la pile des appels**. Ou encore, dans le volet Console, tapez **K**, puis appuyez sur **Entrée**.</span><span class="sxs-lookup"><span data-stu-id="e625e-177">While paused, to see the current call stack, press **CTRL+SHIFT+D** or, on the **Debug** menu, click **Display Call Stack** or, in the Console Pane, type **K** and then press **ENTER**.</span></span>

### <a name="to-stop-debugging"></a><span data-ttu-id="e625e-178">Pour arrêter le débogage</span><span class="sxs-lookup"><span data-stu-id="e625e-178">To stop debugging</span></span>
<span data-ttu-id="e625e-179">Appuyez sur **Maj-F5** ou, dans le menu **Déboguer**, cliquez sur **Arrêter le débogueur**. Ou encore, dans le volet Console, tapez **Q**, puis appuyez sur **Entrée**.</span><span class="sxs-lookup"><span data-stu-id="e625e-179">Press **SHIFT-F5** or, on the **Debug** menu, click **Stop Debugger**, or, in the Console Pane, type **Q** and then press **ENTER**.</span></span>

## <span data-ttu-id="e625e-180"><a name="bkmk_3"></a>Comment effectuer une opération de pas à pas principal, de pas à pas détaillé et de pas à pas sortant lors d’un débogage</span><span class="sxs-lookup"><span data-stu-id="e625e-180"><a name="bkmk_3"></a>How to step over, step into, and step out while debugging</span></span>
<span data-ttu-id="e625e-181">Un pas à pas est le processus consistant à exécuter une instruction à la fois.</span><span class="sxs-lookup"><span data-stu-id="e625e-181">Stepping is the process of running one statement at a time.</span></span> <span data-ttu-id="e625e-182">Vous pouvez arrêter l’exécution sur une ligne de code, puis examiner les valeurs des variables et l’état du système.</span><span class="sxs-lookup"><span data-stu-id="e625e-182">You can stop on a line of code, and examine the values of variables and the state of the system.</span></span> <span data-ttu-id="e625e-183">Le tableau suivant décrit des tâches de débogage courantes, telles que l’exécution d’une opération de pas à pas principal, de pas à pas détaillé et de pas à pas sortant.</span><span class="sxs-lookup"><span data-stu-id="e625e-183">The following table describes common debugging tasks such as stepping over, stepping into, and stepping out.</span></span>

| <span data-ttu-id="e625e-184">Tâche de débogage</span><span class="sxs-lookup"><span data-stu-id="e625e-184">Debugging Task</span></span> | <span data-ttu-id="e625e-185">Description</span><span class="sxs-lookup"><span data-stu-id="e625e-185">Description</span></span> | <span data-ttu-id="e625e-186">Comment l’accomplir dans PowerShell ISE</span><span class="sxs-lookup"><span data-stu-id="e625e-186">How to accomplish it in PowerShell ISE</span></span> |
| --- | --- | --- |
| <span data-ttu-id="e625e-187">**Pas à pas détaillé**</span><span class="sxs-lookup"><span data-stu-id="e625e-187">**Step Into**</span></span> | <span data-ttu-id="e625e-188">Exécute l’instruction en cours, puis s’arrête à l’instruction suivante.</span><span class="sxs-lookup"><span data-stu-id="e625e-188">Executes the current statement and then stops at the next statement.</span></span> <span data-ttu-id="e625e-189">Si l’instruction en cours est une fonction ou appel de script, le débogueur effectue un pas à pas détaillé de cette fonction ou de ce script ; sinon, il s’arrête à l’instruction suivante.</span><span class="sxs-lookup"><span data-stu-id="e625e-189">If the current statement is a function or script call, then the debugger steps into that function or script, otherwise it stops at the next statement.</span></span> | <span data-ttu-id="e625e-190">Appuyez sur **F11** ou, dans le menu **Déboguer**, cliquez sur **Pas à pas détaillé**. Ou encore, dans le volet Console, tapez **S**, puis appuyez sur **Entrée**.</span><span class="sxs-lookup"><span data-stu-id="e625e-190">Press **F11** or, on the **Debug** menu, click **Step Into**, or in the Console Pane, type **S** and press **ENTER**.</span></span> |
| <span data-ttu-id="e625e-191">**Pas à pas principal**</span><span class="sxs-lookup"><span data-stu-id="e625e-191">**Step Over**</span></span> | <span data-ttu-id="e625e-192">Exécute l’instruction en cours, puis s’arrête à l’instruction suivante.</span><span class="sxs-lookup"><span data-stu-id="e625e-192">Executes the current statement and then stops at the next statement.</span></span> <span data-ttu-id="e625e-193">Si l’instruction en cours est un appel de fonction ou un script, le débogueur exécute entièrement la fonction ou le script, puis s’arrête à l’instruction suivante après l’appel de fonction.</span><span class="sxs-lookup"><span data-stu-id="e625e-193">If the current statement is a function or script call then the debugger executes the whole function or script, and it stops at the next statement after the function call.</span></span> | <span data-ttu-id="e625e-194">Appuyez sur **F10** ou, dans le menu **Déboguer**, cliquez sur **Pas à pas principal**. Ou encore, dans le volet Console, tapez **V**, puis appuyez sur **Entrée**.</span><span class="sxs-lookup"><span data-stu-id="e625e-194">Press **F10** or, on the **Debug** menu, click **Step Over**, or in the Console Pane, type **V** and press **ENTER**.</span></span> |
| <span data-ttu-id="e625e-195">**Pas à pas sortant**</span><span class="sxs-lookup"><span data-stu-id="e625e-195">**Step Out**</span></span> | <span data-ttu-id="e625e-196">Sort de la fonction en cours et passe au niveau supérieur si la fonction est imbriquée.</span><span class="sxs-lookup"><span data-stu-id="e625e-196">Steps out of the current function and up one level if the function is nested.</span></span> <span data-ttu-id="e625e-197">Dans le corps principal, le script est exécuté jusqu’à la fin ou jusqu’au point d’arrêt suivant.</span><span class="sxs-lookup"><span data-stu-id="e625e-197">If in the main body, the script is executed to the end, or to the next breakpoint.</span></span> <span data-ttu-id="e625e-198">Les instructions ignorées sont exécutées, mais sans pas à pas.</span><span class="sxs-lookup"><span data-stu-id="e625e-198">The skipped statements are executed, but not stepped through.</span></span> | <span data-ttu-id="e625e-199">Appuyez sur **Maj+F11** ou, dans le menu **Déboguer**, cliquez sur **Pas à pas sortant**. Ou encore, dans le volet Console, tapez **O**, puis appuyez sur **Entrée**.</span><span class="sxs-lookup"><span data-stu-id="e625e-199">Press **SHIFT+F11**, or on the **Debug** menu, click **Step Out**, or in the Console Pane, type **O** and press **ENTER**.</span></span> |
| <span data-ttu-id="e625e-200">**Continuer**</span><span class="sxs-lookup"><span data-stu-id="e625e-200">**Continue**</span></span> | <span data-ttu-id="e625e-201">Continue l’exécution jusqu’à la fin ou jusqu’au point d’arrêt suivant.</span><span class="sxs-lookup"><span data-stu-id="e625e-201">Continues execution to the end, or to the next breakpoint.</span></span> <span data-ttu-id="e625e-202">Les fonctions et appels ignorés sont exécutés, mais sans pas à pas.</span><span class="sxs-lookup"><span data-stu-id="e625e-202">The skipped functions and invocations are executed, but not stepped through.</span></span> | <span data-ttu-id="e625e-203">Appuyez sur **F5** ou, dans le menu **Déboguer**, cliquez sur **Exécuter/Continuer**. Ou encore, dans le volet Console, tapez **C**, puis appuyez sur **Entrée**.</span><span class="sxs-lookup"><span data-stu-id="e625e-203">Press **F5** or, on the **Debug** menu, click **Run/Continue**, or in the Console Pane, type **C** and press **ENTER**.</span></span> |

## <span data-ttu-id="e625e-204"><a name="bkmk_4"></a>Comment afficher les valeurs de variables lors d’un débogage</span><span class="sxs-lookup"><span data-stu-id="e625e-204"><a name="bkmk_4"></a>How to display the values of variables while debugging</span></span>
<span data-ttu-id="e625e-205">À mesure que vous exécutez le code pas à pas, vous pouvez afficher les valeurs actuelles des variables dans le script.</span><span class="sxs-lookup"><span data-stu-id="e625e-205">You can display the current values of variables in the script as you step through the code.</span></span>

### <a name="to-display-the-values-of-standard-variables"></a><span data-ttu-id="e625e-206">Pour afficher les valeurs des variables standards</span><span class="sxs-lookup"><span data-stu-id="e625e-206">To display the values of standard variables</span></span>
<span data-ttu-id="e625e-207">Appliquez l'une des méthodes suivantes :</span><span class="sxs-lookup"><span data-stu-id="e625e-207">Use one of the following methods:</span></span>

-   <span data-ttu-id="e625e-208">Dans le volet Script, placez le curseur sur la variable pour afficher sa valeur dans une info-bulle.</span><span class="sxs-lookup"><span data-stu-id="e625e-208">In the Script Pane, hover over the variable to display its value as a tool tip.</span></span>

-   <span data-ttu-id="e625e-209">Dans le volet Console, tapez le nom de la variable, puis appuyez sur **Entrée**.</span><span class="sxs-lookup"><span data-stu-id="e625e-209">In the Console Pane, type the variable name and press **ENTER**.</span></span>

<span data-ttu-id="e625e-210">Dans ISE, tous les volets sont toujours dans la même étendue.</span><span class="sxs-lookup"><span data-stu-id="e625e-210">All panes in ISE are always in the same scope.</span></span> <span data-ttu-id="e625e-211">Par conséquent, lorsque vous déboguez un script, les commandes que vous tapez dans le volet Console s’exécutent dans l’étendue du script.</span><span class="sxs-lookup"><span data-stu-id="e625e-211">Therefore, while you are debugging a script, the commands that you type in the Console Pane run in script scope.</span></span> <span data-ttu-id="e625e-212">Cela permet d’utiliser le volet Console pour rechercher les valeurs des variables et d’appeler des fonctions qui sont définies uniquement dans le script.</span><span class="sxs-lookup"><span data-stu-id="e625e-212">This allows you to use the Console Pane to find the values of variables and call functions that are defined only in the script.</span></span>

### <a name="to-display-the-values-of-automatic-variables"></a><span data-ttu-id="e625e-213">Pour afficher les valeurs de variables automatiques</span><span class="sxs-lookup"><span data-stu-id="e625e-213">To display the values of automatic variables</span></span>
<span data-ttu-id="e625e-214">Vous pouvez utiliser la méthode précédente pour afficher la valeur de presque toutes les variables pendant que vous déboguez un script.</span><span class="sxs-lookup"><span data-stu-id="e625e-214">You can use the preceding method to display the value of almost all variables while you are debugging a script.</span></span> <span data-ttu-id="e625e-215">En revanche, ces méthodes ne fonctionnent pas pour les variables automatiques suivantes.</span><span class="sxs-lookup"><span data-stu-id="e625e-215">However, these methods do not work for the following automatic variables.</span></span>

-   <span data-ttu-id="e625e-216">$_</span><span class="sxs-lookup"><span data-stu-id="e625e-216">$_</span></span>

-   <span data-ttu-id="e625e-217">$Input</span><span class="sxs-lookup"><span data-stu-id="e625e-217">$Input</span></span>

-   <span data-ttu-id="e625e-218">$MyInvocation</span><span class="sxs-lookup"><span data-stu-id="e625e-218">$MyInvocation</span></span>

-   <span data-ttu-id="e625e-219">$PSBoundParameters</span><span class="sxs-lookup"><span data-stu-id="e625e-219">$PSBoundParameters</span></span>

-   <span data-ttu-id="e625e-220">$Args</span><span class="sxs-lookup"><span data-stu-id="e625e-220">$Args</span></span>

<span data-ttu-id="e625e-221">Si vous essayez d’afficher la valeur d’une de ces variables, vous l’obtenez pour un pipeline interne que le débogueur utilise, pas la valeur de la variable dans le script.</span><span class="sxs-lookup"><span data-stu-id="e625e-221">If you try to display the value of any of these variables, you get the value of that variable for in an internal pipeline the debugger uses, not the value of the variable in the script.</span></span> <span data-ttu-id="e625e-222">Vous pouvez contourner ce comportement pour quelques variables ($_, $Input, $MyInvocation, $PSBoundParameters et $Args) en utilisant la méthode suivante :</span><span class="sxs-lookup"><span data-stu-id="e625e-222">You can work around this for a few variables ($_, $Input, $MyInvocation, $PSBoundParameters, and $Args) by using the following method:</span></span>

1.  <span data-ttu-id="e625e-223">Dans le script, affectez la valeur de la variable automatique à une nouvelle variable.</span><span class="sxs-lookup"><span data-stu-id="e625e-223">In the script, assign the value of the automatic variable to a new variable.</span></span>

2.  <span data-ttu-id="e625e-224">Affichez la valeur de la nouvelle variable, soit en pointant sur celle-ci dans le volet Script, ou en la tapant dans le volet Console.</span><span class="sxs-lookup"><span data-stu-id="e625e-224">Display the value of the new variable, either by hovering over the new variable in the Script Pane, or by typing the new variable in the Console Pane.</span></span>

<span data-ttu-id="e625e-225">Par exemple, pour afficher la valeur de la variable $MyInvocation, dans le script, affectez la valeur à une nouvelle variable, par exemple $scriptname, puis pointez sur la variable $scriptname ou tapez-la pour afficher sa valeur.</span><span class="sxs-lookup"><span data-stu-id="e625e-225">For example, to display the value of the $MyInvocation variable, in the script, assign the value to a new variable, such as $scriptname, and then hover over or type the $scriptname variable to display its value.</span></span>

``` PowerShell
#In MyScript.ps1
$scriptname = $MyInvocation.MyCommand.Path

#In the Console Pane:
C:\ps-test> $scriptname
C:\ps-test\MyScript.ps1
```

## <a name="see-also"></a><span data-ttu-id="e625e-226">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="e625e-226">See Also</span></span>
- [<span data-ttu-id="e625e-227">Utilisation de Windows PowerShell ISE</span><span class="sxs-lookup"><span data-stu-id="e625e-227">Using the Windows PowerShell ISE</span></span>](Using-the-Windows-PowerShell-ISE.md)

